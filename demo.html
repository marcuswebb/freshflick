<html>
<head>
<style>
* {margin:0;padding:0;}
body { width:100%;overflow:hidden;}
ul
	{
		width:1000%;
		height:100px;
		overflow:hidden;
	}
li 
	{
		display:block;
		float:left;
		width:100px;
		height:100px;
		text-indent:-9999px;
	}
li.fresh
	{
		width:3px;
	}
li.rotten { display:none; }
.red 	{		background:red;	}
.blue 	{		background:blue;	}
.green 	{		background:lime;	}
body>div
	{
		position:absolute;
		top:0;
		right:0;
	}
</style>
</head>
<body>
	<div>
		CLICK
	</div>
	<ul>
		<li class="fresh red"></li>
		<li class="fresh green"></li>
		<li class="fresh blue"></li>
	</ul>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script>

$(document).ready(function(){
	copy = $('ul').html();
	stage();
	play();
	$('body>div').click(function(){
		$('.fresh').each(function(){
			$(this)
			.removeClass('fresh')
			.animate({
				'width':3
			}, 400, 'swing')
		}).addClass('stale');
		// $('ul').append();
		stage();
		setTimeout(play, 0);
		//play();
		stale()
	});
});
function stage(){
	i = Math.floor($(window).width() / 100 ) / 3 + 1;
	console.log(i);
	while (i>0)
	  {
		$('ul').append(copy);
	  i--
	  }
}
function play(){
	$('.fresh')
		.css({'margin-left':$(window).width()})
		.animate({
		'width':100
	}, 300, 'swing').animate({
		'marginLeft':0
	}, 500, 'linear')
}
function stale(){
	$('.rotten').remove();
	if ($('li.stale').length > 45) {
		console.log('asdf');
		$('li:lt(40)').animate({
			'width':0
		}, 250, 'swing', function(){
			$(this).addClass('rotten');
		});
	}
}
</script>
</body>
</html>
